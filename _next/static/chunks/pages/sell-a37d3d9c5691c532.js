(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6276],{68391:function(e,t,s){"use strict";var r=s(59499),n=s(34123),i=s(68351),a=s(88767),l=s(73574),c=s(56371);function o(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}t.Z=({tokenAddress:e,slp:t},s)=>{const{network:d,provider:m}=(0,n.gK)();return(0,a.useQuery)(["spotPrice",d,e,t],(async()=>{const s=await(0,i.Z)({chainId:d,provider:m,slpAddress:t?e:void 0,token0:t?void 0:e});return(0,l.Z)({chainId:d,provider:m,reserveVtoken:(0,c.formatEther)(s.reserveVtoken),reserveWeth:(0,c.formatEther)(s.reserveWeth)})}),function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?o(Object(s),!0).forEach((function(t){(0,r.Z)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):o(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({enabled:!!(d&&m&&e)},s))}},54865:function(e,t,s){"use strict";s.d(t,{b:function(){return r}});const r=(e,t)=>Number(e)<Date.now()/1e3&&t.gt(0)},45341:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ie}});var r=s(51971),n=s(74763),i=s(86603),a=s(85528),l=s(8923),c=s(61476),o=s(57584),d=s(76250),m=s(76497),u=s(1750),x=s(21046),h=s(41664),j=s(54490),v=s(44012),b=s(85893);var p=({vault:e,bond:t,asset:s,discount:r})=>{const n=r<0;return(0,b.jsx)(h.default,{href:`/sell/${t.id}`,passHref:!0,children:(0,b.jsxs)("a",{className:"bg-gray-700 rounded-md overflow-hidden hover:bg-gray-500 hover:bg-opacity-20 transition-colors flex flex-col",children:[(0,b.jsx)("div",{className:"h-0 w-full relative overflow-hidden rounded-md",style:{paddingTop:"100%",backgroundColor:null===s||void 0===s?void 0:s.backgroundColor},children:(0,b.jsx)("img",{className:"w-full h-full absolute top-0 object-cover",src:(null===s||void 0===s?void 0:s.imageUrl)||"/images/nftx-placeholder.png",alt:e.asset.name})}),(0,b.jsxs)("div",{className:"p-3 flex-1 flex flex-col",children:[(0,b.jsx)("h5",{className:"mb-2 truncate",children:e.asset.name}),(0,b.jsxs)("div",{className:"text-xs text-gray-600",children:[(0,b.jsx)(v.Z,{id:"bond.721.bonus",values:{b:e=>(0,b.jsx)("b",{children:e})}})," ",(0,b.jsxs)("span",{className:""+(n?"text-red-400":"text-green-400"),children:[n?null:"+",(0,b.jsx)(j.BK,{style:"percent",value:r,minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]})})};var f=({vault:e,bond:t})=>{const{data:s=x._Y}=(0,d.Z)(),{data:r}=(0,m.Z)({assetAddress:e.asset.id,tokenId:e.holdings[0].tokenId}),n=(0,u.E)(s,null===t||void 0===t?void 0:t.bondPrice);return(0,b.jsx)(p,{vault:e,bond:t,asset:r,discount:n})},g=s(67294);var y=({children:e})=>g.Children.count(e)>0?(0,b.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:e}):(0,b.jsx)("p",{className:"text-center",children:(0,b.jsx)(v.Z,{id:"bonds.721.none"})});var w=()=>{const{data:e}=(0,r.Z)(),{data:t}=(0,n.Z)();return t&&e?(0,b.jsx)(i.Z,{header:(0,b.jsx)(c.Z,{}),main:(0,b.jsx)(y,{children:e.filter((e=>e.active)).map((e=>t.filter((t=>(0,a.Q)(e.principal,t.id))).map((t=>(0,b.jsx)(f,{vault:t,bond:e},`${e.id}-${t.id}`)))))}),basket:(0,b.jsx)(l.Z,{vestingPeriod:null,symbol:null})}):(0,b.jsx)(o.Z,{})},O=s(25081),N=s(92328),k=s(39229);var Z=async(e,t)=>{var s,r;const n=await(0,N.Z)({url:(0,O.Z)(k.Ax,t),query:`query TimelockNotes {\n      sellTimelockNotes(where: {\n        user: ${JSON.stringify(e.toLowerCase())}\n        claimed: false\n      }, orderBy: timelockEndsAt, orderDirection: asc) {\n        vault {\n          id\n          symbol\n        }\n        amount\n        timelockEndsAt\n        claimed\n        index\n      }\n    }`});return null!==(s=null===n||void 0===n||null===(r=n.sellTimelockNotes)||void 0===r?void 0:r.map((e=>({symbol:e.vault.symbol,vault:e.vault.id,amount:e.amount,claimed:e.claimed,timelockEndsAt:e.timelockEndsAt,index:e.index}))))&&void 0!==s?s:[]},E=s(57495),P=s(88767);var D=e=>{const{chainId:t}=(0,E.K)();return(0,P.useQuery)(["lockedAssets",e],(()=>Z(e,t)),{enabled:!(!e||!t)})},A=s(77534),C=s(59499),S=s(9870),_=s(7177),I=s(11466),T=s(27007);var $=({chainId:e,provider:t,userAddress:s,indexes:r,vault:n})=>{const i=new I.CH((0,O.Z)(_.Yx,e),T,t.getSigner());try{return i.claim(s,r,n)}catch(a){throw new Error(a)}},K=s(34165),M=s(56371),H=s(86896);var Q=()=>{const{address:e}=(0,A.tN)(),{chainId:t,library:s}=(0,E.K)(),{showErrorModal:r}=(0,S.vR)(),n=(()=>{const{formatMessage:e}=(0,H.Z)(),{showSuccessModal:t}=(0,S.vR)(),{chainId:s}=(0,E.K)();return(r,n,i)=>{t({chainId:s,receipt:r,title:e({id:"modal.success.timelock.claim.title"}),text:e({id:"modal.success.timelock.claim.text"},{amount:(0,M.formatEther)(n),symbol:i})})}})(),i=(()=>{const e=(0,P.useQueryClient)();return()=>{e.invalidateQueries({queryKey:"depositories",exact:!1}),e.invalidateQueries({queryKey:"vestingBonds",exact:!1})}})();return(0,K.Z)((({index:r,vault:n})=>$({chainId:t,provider:s,userAddress:e,indexes:[r],vault:n})),{onSuccess(e,t){n(e,t.amount,t.symbol),i()},onError(e){r({error:e})}})},B=s(68391),V=s(2593),W=s(50036),q=s(10768),z=s(30776),Y=s(25705),F=s(54865),R=s(97735),U=s(3645),L=s(21225);var X=({symbol:e,timelockEndsAt:t,amount:s,claiming:r,claimed:n,pending:i,onClaimClick:a,ethValue:l})=>{const{0:c,1:o}=(0,g.useState)((()=>(0,F.b)(t,V.O$.from(s))));return(0,g.useEffect)((()=>{if(!c){const e=1e3*Number(t)-Date.now()+1e3,r=setTimeout((()=>{o((0,F.b)(t,V.O$.from(s)))}),e);return()=>clearTimeout(r)}}),[s,t,c]),(0,b.jsxs)(W.Z,{className:"sm:flex items-center",children:[(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(U.Z,{size:32,name:e,slp:!1}),(0,b.jsx)("span",{className:"mx-2",children:e.toUpperCase()})]}),(0,b.jsxs)("div",{className:"sm:flex sm:ml-auto sm:space-x-12 mt-4 sm:mt-0",children:[(0,b.jsxs)("div",{className:"sm:text-center flex justify-between sm:block mb-1 sm:mb-0",children:[(0,b.jsx)("h5",{className:"sm:mb-2",children:(0,b.jsx)(v.Z,{id:"timelock.amount"})}),(0,b.jsxs)("div",{className:"text-white",children:[(0,b.jsx)(j.BK,{value:(0,L.Z)(s)})," ",e]})]}),(0,b.jsxs)("div",{className:"sm:text-center flex justify-between sm:block mb-1 sm:mb-0",children:[(0,b.jsx)("h5",{className:"sm:mb-2",children:(0,b.jsx)(v.Z,{id:"timelock.value"})}),(0,b.jsx)("div",{className:"text-white",children:l?(0,b.jsx)(R.Z,{value:l}):"\u2014"})]}),n?(0,b.jsxs)("div",{className:"sm:text-center flex justify-between sm:block mb-1 sm:mb-0",children:[(0,b.jsx)("h5",{className:"sm:mb-2",children:(0,b.jsx)(v.Z,{id:"common.status"})}),(0,b.jsx)("div",{className:"text-teal-500",children:(0,b.jsx)(v.Z,{id:"timelock.withdrawn"})})]}):c?(0,b.jsx)("div",{className:"text-center w-full mt-4 sm:mt-0 sm:w-auto",children:(0,b.jsx)(q.ZP,{disabled:!c||i||r,onClick:a,kind:z.hY.INVERSE,state:r||i?z.ZM.BUSY:z.ZM.IDLE,children:(0,b.jsx)(v.Z,{id:"timelock.withdraw"})})}):(0,b.jsxs)("div",{className:"sm:text-center flex justify-between sm:block mb-1 sm:mb-0",children:[(0,b.jsx)("h5",{className:"sm:mb-2",children:(0,b.jsx)(v.Z,{id:"timelock.unlocks"})}),(0,b.jsx)("div",{className:"text-teal-500",children:(0,b.jsx)(Y.Z,{time:Number(t)})})]})]})]})};function J(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}function G(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?J(Object(s),!0).forEach((function(t){(0,C.Z)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):J(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var ee=e=>{let t=Object.assign({},e);const{isMining:s,isPending:r,mutate:n,isSuccess:i}=Q(),{data:a}=(0,B.Z)({tokenAddress:t.vault}),l=s,c=a?null===a||void 0===a?void 0:a.mul(t.amount).div(x.Ce):null;return(0,b.jsx)(X,G(G({},t),{},{claiming:l,pending:r,ethValue:c,onClaimClick:()=>{n({index:t.index,vault:t.vault,amount:V.O$.from(t.amount),symbol:t.symbol})},claimed:i}))};function te(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,r)}return s}var se=({timelockedAssets:e})=>(0,b.jsxs)("div",{children:[(0,b.jsx)("header",{className:"flex justify-between items-center",children:(0,b.jsx)("h3",{className:"",children:(0,b.jsx)(v.Z,{id:"timelocked.title",values:{count:e.length}})})}),(0,b.jsx)("div",{className:"mt-6 space-y-4 text-gray-300",children:e.map((e=>(0,b.jsx)(ee,function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?te(Object(s),!0).forEach((function(t){(0,C.Z)(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):te(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({},e),e.index)))})]});var re=()=>{const{address:e}=(0,A.tN)(),{data:t,status:s}=D(e);return"success"===s&&null!==t&&void 0!==t&&t.length?(0,b.jsx)(se,{timelockedAssets:t}):null},ne=s(9008);var ie=()=>{const{formatMessage:e}=(0,H.Z)();return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(ne.default,{children:[(0,b.jsx)("title",{children:e({id:"meta.bond721.title"})}),(0,b.jsx)("meta",{name:"description",content:e({id:"meta.bond721.description"})}),(0,b.jsx)("meta",{property:"og:title",name:"twitter:title",content:e({id:"meta.bond721.title"})}),(0,b.jsx)("meta",{property:"og:description",name:"twitter:description",content:e({id:"meta.bond721.description"})})]}),(0,b.jsx)("div",{className:"my-20 container mx-auto w-full max-w-6xl",children:(0,b.jsxs)("div",{className:"px-6 space-y-12",children:[(0,b.jsx)(re,{}),(0,b.jsx)(w,{})]})})]})}},3645:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var r=s(25675),n=s(85893);var i=({slp:e,name:t,size:s=48,src:i=`/images/tokens/256x256/${e?t.replace(/(WETH|WEETH)/,""):t}.png`})=>{const a=32===s?"w-8 h-8":"w-12 h-12";return(0,n.jsxs)("span",{className:"inline-flex items-center",children:[(0,n.jsx)("span",{className:`${a} flex-none ${e?32===s?"-mr-3 z-10":"-mr-6 z-10":""}`,children:i.startsWith("/")?(0,n.jsx)(r.default,{src:i,width:s,height:s,alt:t}):(0,n.jsx)("img",{src:i,width:s,height:s,alt:t})}),e?(0,n.jsx)("span",{className:`${a} flex-none`,children:(0,n.jsx)(r.default,{src:"/images/tokens/256x256/ETH.png",width:s,height:s,alt:"ETH"})}):null]})}},94207:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/sell",function(){return s(45341)}])}},function(e){e.O(0,[1466,5675,7996,9774,2888,179],(function(){return t=94207,e(e.s=t);var t}));var t=e.O();_N_E=t}]);